<VirtualHost *:80>
    #ServerName glpi.customer.fr

    RewriteEngine On
    RewriteCond %{HTTP:X-Forwarded-Proto} !https
    RewriteRule ^(.*)$ https://%{HTTP_HOST}%{REQUEST_URI} [L,R=301]
</VirtualHost>

<VirtualHost *:443>
    ServerName glpi.customer.fr
    DocumentRoot "/var/www/glpi/public"
    Alias "/glpi" "/var/www/glpi/public"

    <Directory "/var/www/glpi/public">
        Options Indexes FollowSymLinks
        AllowOverride all
        Require all granted
    </Directory>

    SSLEngine on
    SSLCertificateFile      /etc/ssl/certs/CertifCBM2023.pem
    SSLCertificateKeyFile /etc/ssl/private/privatekey.key

    RewriteEngine On
    RewriteCond %{HTTP_HOST} !^glpi\.customer\.fr$ [NC]
    RewriteRule ^(.*)$ https://glpi.customer.fr/$1 [R=301,L]
    Header always set Strict-Transport-Security "max-age=31536000; includeSubDomains; preload"
</VirtualHost>
